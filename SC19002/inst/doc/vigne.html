<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Vignette Author" />

<meta name="date" content="2019-12-30" />

<title>Vignette Title</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Vignette Title</h1>
<h4 class="author">Vignette Author</h4>
<h4 class="date">2019-12-30</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p><em>SC19002</em> is a simple R packages developed to write two functions and record the homework througth the ‘Statistical Computing’ course.Two functions are considered, namely, <em>sk</em>(generate the skewness coefficient of a sample)and <em>chisqtest</em>(cao do a chis-squared test statistic of two samples, give the statistic ,dimension of freedom and p-value).And the rest is my homework answers.</p>
</div>
<div id="homework-answers" class="section level2">
<h2>Homework Answers</h2>
<p>Homework 1</p>
<p>exercise 3.4</p>
<p><span class="math inline">\(f(x)=\frac{x}{\sigma^{2}} e^{-x^{2} /\left(2 \sigma^{2}\right)}, \quad x \geq 0,\quad \sigma&gt;0\)</span>. Then we conclude that <span class="math inline">\(F(x)=1-e^{-\frac{x^2}{2\sigma^2}}\)</span>. Then <span class="math inline">\(F^{-1}(x)=\sqrt{-2\sigma^2\ln(1-x)}\)</span>, so we can use the inverse transform method.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">n &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">#par(mfrow = c(2, 2))</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">set.seed</span>(<span class="dv">75</span>)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb1-5" title="5">sigma &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^</span>(i<span class="dv">-2</span>)</a>
<a class="sourceLine" id="cb1-6" title="6">u  &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb1-7" title="7">x &lt;-<span class="st"> </span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-8" title="8">h &lt;-<span class="st"> </span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-9" title="9">h &lt;-<span class="st"> </span>h<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>h<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)) <span class="co"># to find the maximum value of f(x)</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#par(mar=c(5.1, 4.1, 4, 2.1)) # to let the formula show complete</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x) <span class="op">==</span><span class="st"> </span><span class="kw">frac</span>(x,sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>e<span class="op">^-</span><span class="kw">frac</span>(x<span class="op">^</span><span class="dv">2</span>,<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)), <span class="dt">sub =</span> <span class="kw">paste</span>(<span class="st">&quot;sigma&quot;</span>,<span class="st">&quot;=&quot;</span>,sigma), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.1</span><span class="op">*</span>h))</a>
<a class="sourceLine" id="cb1-12" title="12">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, (<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="fl">0.001</span>))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>), <span class="fl">.01</span>) <span class="co"># to let the x-range of hist and line be similar</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="kw">lines</span>(y, y<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb1-14" title="14">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>As the figures show, we set <span class="math inline">\(\sigma\)</span> to be 0.1, 1, 10, 100, and in each condition we compare the histogram and f(x), then we find that the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma\)</span>.</p>
<p>exercise 3.11</p>
<p>We need to generate a random samples of a mixture of two normal distribution, so we can use the transformation method.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">set.seed</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb2-3" title="3">x1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-4" title="4">x2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-5" title="5">u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb2-6" title="6">p1 &lt;-<span class="st"> </span><span class="fl">0.75</span></a>
<a class="sourceLine" id="cb2-7" title="7">k &lt;-<span class="st"> </span><span class="kw">as.integer</span>(u <span class="op">&lt;</span><span class="st"> </span>p1)</a>
<a class="sourceLine" id="cb2-8" title="8">z1 &lt;-<span class="st"> </span>k<span class="op">*</span>x1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>k)<span class="op">*</span>x2</a>
<a class="sourceLine" id="cb2-9" title="9"><span class="kw">hist</span>(z1, <span class="dt">prob =</span> T, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;mixture&quot;</span>,<span class="st">&quot;with&quot;</span>,<span class="st">&quot;p1&quot;</span>,<span class="st">&quot;=&quot;</span>,p1))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co">#par(mfrow = c(3,3))</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>) {</a>
<a class="sourceLine" id="cb3-3" title="3">u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb3-4" title="4">p1 &lt;-<span class="st"> </span><span class="fl">0.1</span><span class="op">*</span>i</a>
<a class="sourceLine" id="cb3-5" title="5">k &lt;-<span class="st"> </span><span class="kw">as.integer</span>(u <span class="op">&lt;</span><span class="st"> </span>p1)</a>
<a class="sourceLine" id="cb3-6" title="6">z1 &lt;-<span class="st"> </span>k<span class="op">*</span>x1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>k)<span class="op">*</span>x2</a>
<a class="sourceLine" id="cb3-7" title="7"><span class="kw">hist</span>(z1, <span class="dt">prob =</span> T, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;mixture&quot;</span>,<span class="st">&quot;with&quot;</span>,<span class="st">&quot;p1&quot;</span>,<span class="st">&quot;=&quot;</span>,p1))</a>
<a class="sourceLine" id="cb3-8" title="8">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAApVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZrY6AAA6ADo6AGY6OgA6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmtttmtv+QOgCQZgCQZjqQtpCQttuQ27aQ29uQ2/+2ZgC2Zjq2ZpC227a229u22/+2/9u2///bkDrbkGbbtmbbtpDb29vb2//b/7bb////tmb/25D/27b//7b//9v////Qcxm6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJQklEQVR4nO2da2ObNgBFcZfU7rq1s9ctTh9b6Lq0tN1W3Jj//9OmF4/YoCuMAAH3fEgbRxLSsZAEEiLKiJVo7AyEDgUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFAToR9DxNrr+9viTvz51SEjFTqLVnTVwfHrQRym9j6LV7+Xfj2+i6IcbnIOBBH1/9aSDIB0bCJIGmgWJhCTr/PeHnfr9JczBQKdYHF0mqBrbLujrq8gmSER+l32Oon2R5OpOSts3RcjxIkh8Heuvz6PVTfZ5E13dmS/+sJHlEv998imW35b8RxZUhN6qHL99FT2513X/ZV4yfZrEKudpFN3IhExsEeNPEfaqsCSS+/Cb+OBeCYhWm1KQOLbGOBW5WOc/8xyrUOsM4EuQ5rkuijkzRKa38sc+qxUUqa/cxL0yFSyVRZKfbZWAj48EaYq6GFckJNHV37fNgvQxy1ZK/H2rPrW0Wp4FbbMvIj832ooWJH6u3m5MlZDFOhF0fZ/9Iz+7N/k1Od+r4q3V960Tyk8xGUOlXwgScb+oluXzy29HiyBzgOJM17+r2j2QIJE1/VMd2uRVZVNlsVbQPiu+2iTPqToLElVPpKsTQfsighG0r5T6vOssORWkTzHxczBB68p5XQhSJ8E2y+oFKXOnX7X4XJ5TT3erOyntsSAZRh8lKxMtGu82gnQjHUdjC0o3JvNVQTqzplhpdCJINEJ/7GTjvJUNhoug1PRFbU6xIsC4gtTgw1SlBkGqzTlJ6+eNrD5Pd0VC7WsQaqTlyCxa/fJ6uEa6VlCi+rXyq9NFSaOKoEp5i2JLqakuHBDU2AbVdPO613h0sPODn9OnIPHf6/92phfWP8Xfvt9WBcnG4Cb7XulvUzXglR2jLpIaL5RpPBZU9GKZvQ2SkW/0QFEFE4OvJ/f44iXrVZDs5e9kede61Kpf0lQEmXFQmVMZSBXDDO1EodN8oHgmqNqOWAWVlxplklE5YmimR0FpfnbJ8r5XI96DuB548aHai4nG4I0w8uK+WhRT2/bFqaFi17VBH9+Uca2CRBobfbFqgslLk6t3uGxTvt3R7QLPEQoCUBCAggBTFjQIFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKArQTZJYADDEfFQqtBCX5aojUYVnETGgj6HhbaEngyqy50EbQw65YLZcu5iRjDQK0bINMFWIb1ED+zMFi6g/HQZCABUVnjJKL9lHS6prUHjnL2gQExVG0Pfz0rdrh98cEBcVy1buqPUN089MTpOrN4Zl6BmWM1YETECRHP8d/s15qEG6TgxeUJXm90aoqqXjoaLCP8AVlie6+0saHhZcuqM/kKKht1EkLShp6MQrqLzkKahuVgkDUKQqCsxoLF4RnNZYtyOGe9LIFOcxqLFsQaxACz2osXBCe1Vi6oD6Tm7Ug3g8aIDkKahuVgkDUwAS5bDbUIjkPUQMTpHc27LpoY9aCMg+O5i4oM1sYekuuS9QABcl9q+TuWJfPCs5ZkNlWLes0rzxjQQ87H2ta5izoV+2n27KEBQhqmvFqmZyHqEEJisvLTXbz9QfNa5Cn5DxEDUzQ6MnNWtDs7wc97LbFvvRspPs86LIF6YV36VKnnmXxE+tjGEqQmhFrXCc9Z0GxfFXIOoubb5tJQUbNAicOZcnl4kzLpYYUdNgoQQucepaCYlFsy6XGsmuQOLcedvJNMrZTzOx6frZOuia5Djlx/mAIHt0Pki9Mst+5V4EsDxzOWdDYyVFQ26ihCfKyq8KcBcU+nnCasaDGjqmkuJ5trmezFoSfsjzeolo2Y0Gog3cLNGNBlofAKjQEmv0Ns6zSwLAX6/OgFNRfcg6CxtiLoXII9ZbL2G1aLJAH6gYVlK7uEnk1P6WJwyEFyecM5F2eSU09DylIDhSloEktXhijBsW21VP+HqhzaHADE2TaoMQ2XPT4QJ1DYUMTpIeKtlVUPh+HmqIgiM8H6mYpaNk1SF+L2de3enygbnKCYl32xL7AzN8DdVMTlOaNs5k57ZjcJQGDFlS5EWaZm7ek0vrqcWKCKldgA11qTE6Qp31+KcgpuYsCUhAISEEgYOCC4JRgm+QuChi0oOGTo6DWASkIBKQgEJCCQEAKAgEpCASkIBCQgkDAiwT1P1nvJ8Vg7geFKqh9cjMV5HFmFX8yQUHhz6yOK2gC82LjCprAzCprUOsgXWnZBoU+s+p/GWO7+MHPrPofbA80DnL4YhcuCAechaCLB4oLEXT5QHFEQR1b7YG6+YBqUI+COgwUlyGINQjROFA8OcFrhmsB0aMgvqmXnEFBgAsFdVuoNyV6qUHjNsIndC2LFyPtEw0pSK/xL000pCAe4ztugBJS6QO7WHVONKQg3uI7XGo4JxpSEG/xndfChlR61qDuQfzFx7MazomGFMRjfMeL1ZBKH+Q4aE5QEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgQF+CrFuhmZvbtlsmqX0zLJcknDIC6UlQar8jcrwVpU8srwaWu9GkVkMwCaeMYPoRpDb1tPxdb8LTPD2r711aN6JBSbhlBNOPoOT6tUO+mquIW+mtSbTJiI1eBB2e3bmc+s276IsEMqddMsBG/I4ZsdGHIHmCOOTLcmNbVwxUPeC9cceMWOlDENzQU5GCNtpBkC0J94zY6UGQOj9gvqxfvtspBuqPY0YAfgWp17EnZt1J/W5x5o3t9u32nBppsGOfPlRzRhwZaaBo3TLWqZtHSThmBDKOoMMGfPl4oAiTcMoIZhxBpvJbDCToUgMn4ZIRDC9WARQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDARAQdfhxrO55pCHrYjbZf0SQEpR1f6tWFkAXpFS5budSu22vhuhCyIIlZhkdBDeTvxaWgeo63Zn0YBdWT5CvsKKiWcqEmBdVRnGAUVE9SLmGloBryLfdkP0ZBwUJBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQH+B3JLJZnvTyX5AAAAAElFTkSuQmCC" /><!-- --></p>
<p>First, we graph the histogram of the mixture with p1 = 0.75, we find that it is unimodal. Then we graph the histogram with p1 from 0.1 to 0.9, and we find that when p1 is around 0.5, the histogram shows like bimodal. Finally, we can make the conjecture that p1 = 0.5 produce the bimodal mixtures.</p>
<p>exercise 3.18</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">n =<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb4-2" title="2">Sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">.9</span>, <span class="fl">.9</span>, <span class="dv">1</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">set.seed</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb4-4" title="4">rwish.bart &lt;-<span class="st"> </span><span class="co"># a function to generate samples from a Wishart distribution Wd(n,Sigma) based on Bartlett&#39;s decomposition</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="st">  </span><span class="cf">function</span>(n, Sigma){ <span class="co">#n&gt;d+1&gt;=1</span></a>
<a class="sourceLine" id="cb4-6" title="6">    d =<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">length</span>(Sigma))</a>
<a class="sourceLine" id="cb4-7" title="7">    T &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="dv">0</span>,d<span class="op">^</span><span class="dv">2</span>), <span class="dt">nrow =</span> d, <span class="dt">ncol =</span> d)</a>
<a class="sourceLine" id="cb4-8" title="8">    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d) {</a>
<a class="sourceLine" id="cb4-9" title="9">      <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d) {</a>
<a class="sourceLine" id="cb4-10" title="10">        <span class="cf">if</span> (i<span class="op">&gt;</span>j){T[i,j] =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)} </a>
<a class="sourceLine" id="cb4-11" title="11">        <span class="cf">if</span> (i<span class="op">==</span>j){T[i,j] =<span class="st"> </span><span class="kw">rchisq</span>(<span class="dv">1</span>, n<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>)}</a>
<a class="sourceLine" id="cb4-12" title="12">      }</a>
<a class="sourceLine" id="cb4-13" title="13">    }</a>
<a class="sourceLine" id="cb4-14" title="14">    A &lt;-<span class="st"> </span>T <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(T)</a>
<a class="sourceLine" id="cb4-15" title="15">    L &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">chol</span>(Sigma))</a>
<a class="sourceLine" id="cb4-16" title="16">    X &lt;-<span class="st"> </span>L <span class="op">%*%</span><span class="st"> </span>A <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(L)</a>
<a class="sourceLine" id="cb4-17" title="17">    X</a>
<a class="sourceLine" id="cb4-18" title="18">  }</a>
<a class="sourceLine" id="cb4-19" title="19"><span class="kw">rwish.bart</span>(n, Sigma)</a></code></pre></div>
<pre><code>##          [,1]     [,2]
## [1,] 4.029775 4.062549
## [2,] 4.062549 4.098733</code></pre>
<p>We write a function named rwish.bart to generate a random sample from a <span class="math inline">\(W_d(\Sigma, n)\)</span> (Wishart) distribution for <span class="math inline">\(n &gt; d+1\ge1\)</span> based on Bartlett’s decomposition. And, we generate a sample with <span class="math inline">\(n=3, \Sigma=\left[\begin{array}{cc}{1.0} &amp; {0.9} \\ {0.9} &amp; {1.0}\end{array}\right]\)</span>.</p>
<p>Homework 2</p>
<p>exercise 5.1</p>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\int_{0}^{\pi / 3} \sin t d t\]</span> and compare the estimate with the exact value of the integral.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">m &lt;-<span class="st"> </span><span class="fl">1e4</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">set.seed</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb6-3" title="3">x &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb6-4" title="4">theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(x))<span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="kw">print</span>(<span class="kw">c</span>(theta.hat,<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)<span class="op">+</span><span class="kw">cos</span>(<span class="dv">0</span>)))<span class="co">#Compare the estimte and the true value</span></a></code></pre></div>
<pre><code>## [1] 0.4992055 0.5000000</code></pre>
<p>exercise 5.10</p>
<p>Use Monte Carlo integration with antithetic variables to estimate <span class="math display">\[\int_{0}^{1} \frac{e^{-x}}{1+x^{2}} d x\]</span> and find the approximate reduction in variance as a percentage of the variance without variance reduction.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">MC &lt;-<span class="st"> </span><span class="cf">function</span>( R , <span class="dt">antithetic =</span> <span class="ot">TRUE</span>) { <span class="co"># Write a function to generate the estimate with antithetic variables or not</span></a>
<a class="sourceLine" id="cb8-2" title="2">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-3" title="3">  <span class="cf">if</span> (<span class="op">!</span>antithetic) v &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span> v &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u</a>
<a class="sourceLine" id="cb8-4" title="4">  u &lt;-<span class="st"> </span><span class="kw">c</span>(u, v)</a>
<a class="sourceLine" id="cb8-5" title="5">  theta &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">exp</span>(<span class="op">-</span>u)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb8-6" title="6">  theta</a>
<a class="sourceLine" id="cb8-7" title="7">}</a>
<a class="sourceLine" id="cb8-8" title="8">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb8-9" title="9">MC1 &lt;-<span class="st"> </span>MC2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb8-10" title="10"><span class="kw">set.seed</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb8-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb8-12" title="12">  MC1[i] &lt;-<span class="st"> </span><span class="kw">MC</span>(<span class="dt">R =</span> <span class="dv">1000</span>, <span class="dt">anti =</span> <span class="ot">FALSE</span>)<span class="co"># the estimate without variance reduction</span></a>
<a class="sourceLine" id="cb8-13" title="13">  MC2[i] &lt;-<span class="st"> </span><span class="kw">MC</span>(<span class="dt">R =</span> <span class="dv">1000</span>)<span class="co"># the estimate with variance reduction</span></a>
<a class="sourceLine" id="cb8-14" title="14">}</a>
<a class="sourceLine" id="cb8-15" title="15"><span class="kw">c</span>(<span class="kw">sd</span>(MC1),<span class="kw">sd</span>(MC2),<span class="kw">sd</span>(MC2)<span class="op">/</span><span class="kw">sd</span>(MC1))</a></code></pre></div>
<pre><code>## [1] 0.007618082 0.001478508 0.194078734</code></pre>
<p>The Monte Carlo integration with antithetic variables in this example reduce approximate 80 percent of the variance without variance reduction.</p>
<p>exercise 5.15</p>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">M &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb10-2" title="2">k &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb10-3" title="3">r &lt;-<span class="st"> </span>M<span class="op">/</span>k <span class="co"># replicates per stratum</span></a>
<a class="sourceLine" id="cb10-4" title="4">N &lt;-<span class="st"> </span><span class="dv">100</span> <span class="co"># number of times to repeat the estimation</span></a>
<a class="sourceLine" id="cb10-5" title="5">T2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb10-6" title="6">estimate &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-7" title="7">g &lt;-<span class="st"> </span><span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-8" title="8">f &lt;-<span class="st"> </span><span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb10-9" title="9">F &lt;-<span class="st"> </span><span class="cf">function</span>(x)<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))) <span class="co"># the inverse function of the cdf of f(x)</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="kw">set.seed</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb10-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) </a>
<a class="sourceLine" id="cb10-12" title="12">{</a>
<a class="sourceLine" id="cb10-13" title="13">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(M)</a>
<a class="sourceLine" id="cb10-14" title="14">  x &lt;-<span class="st"> </span><span class="kw">F</span>(u)</a>
<a class="sourceLine" id="cb10-15" title="15">  estimate[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(x)<span class="op">/</span><span class="kw">f</span>(x))</a>
<a class="sourceLine" id="cb10-16" title="16">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k ) </a>
<a class="sourceLine" id="cb10-17" title="17">  {</a>
<a class="sourceLine" id="cb10-18" title="18">    u &lt;-<span class="st"> </span><span class="kw">runif</span>( M<span class="op">/</span>k, <span class="kw">F</span>((j<span class="dv">-1</span>)<span class="op">/</span>k),<span class="kw">F</span>(j<span class="op">/</span>k))</a>
<a class="sourceLine" id="cb10-19" title="19">    x&lt;-<span class="st"> </span><span class="kw">F</span>(u)</a>
<a class="sourceLine" id="cb10-20" title="20">    T2[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(x)<span class="op">/</span>(<span class="kw">f</span>(x)))</a>
<a class="sourceLine" id="cb10-21" title="21">  }</a>
<a class="sourceLine" id="cb10-22" title="22">  estimate[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(T2)</a>
<a class="sourceLine" id="cb10-23" title="23">}</a>
<a class="sourceLine" id="cb10-24" title="24">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">rbind</span>(<span class="kw">apply</span>(estimate,<span class="dv">2</span>,mean),<span class="kw">apply</span>(estimate,<span class="dv">2</span>,sd)), <span class="dt">formate =</span> <span class="st">&quot;html&quot;</span>,<span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;5.10&quot;</span>,<span class="st">&quot;5.13&quot;</span>))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">5.10</th>
<th align="right">5.13</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.5248858</td>
<td align="right">0.5492678</td>
</tr>
<tr class="even">
<td align="right">0.0010201</td>
<td align="right">0.0002136</td>
</tr>
</tbody>
</table>
<p>The standerd error of the stratified importance sampling estimate in Example 5.13 is only 20 percent of that result of Example 5.10.</p>
<p>Homework 3</p>
<p>exercise 6.5</p>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use aMonte Carlo experiment to estimate the coverage probability of the t-interval for random samples of χ2(2) data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
<p>As we know while <span class="math inline">\(X_i\)</span> are normally distributed random variables, then <span class="math display">\[
\overline{\boldsymbol{x}} \pm t_{\alpha / 2, n-1}\left(\frac{s}{\sqrt{n}}\right)
\]</span> is the t-interval for th mean.</p>
<p>Note that the mean of χ2(n) is n and the variance is 2n.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb11-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb11-3" title="3">N &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb11-4" title="4">TL1 &lt;-<span class="st"> </span>TL2 &lt;-<span class="st"> </span>UCL &lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb11-5" title="5"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb11-6" title="6"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb11-7" title="7">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-8" title="8">  y &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sqrt</span>(<span class="kw">var</span>(x)<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb11-9" title="9">  TL1[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">-</span>y<span class="co"># the lower confidence limit of t-interval</span></a>
<a class="sourceLine" id="cb11-10" title="10">  TL2[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">+</span>y<span class="co"># the upper confidence limit of t-interval</span></a>
<a class="sourceLine" id="cb11-11" title="11">  UCL[i] &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">qchisq</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>)<span class="co"># the upper confidence limit of the variance</span></a>
<a class="sourceLine" id="cb11-12" title="12">}</a>
<a class="sourceLine" id="cb11-13" title="13"><span class="kw">mean</span>(TL1 <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>TL2 <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>)<span class="co"># the coverage probability of the t-interval</span></a></code></pre></div>
<pre><code>## [1] 0.918</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">mean</span>(UCL <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>)<span class="co"># the coverage probability of the one side confidence interval of the variance</span></a></code></pre></div>
<pre><code>## [1] 0.77</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a></code></pre></div>
<p>We find that the cverage probability of the t-interval shows better, so the t-interval could be more robust to departures from normality than the interval for variance.</p>
<p>exercise 6.6</p>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness <span class="math inline">\(\sqrt{b_1}\)</span>under normality by a Monte Carlo experiment. Compute the standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula). Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_{1}} \approx N(0,6 / n)\)</span>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">n &lt;-<span class="st"> </span><span class="dv">100</span><span class="co">#the size of normal samples</span></a>
<a class="sourceLine" id="cb16-2" title="2">m &lt;-<span class="st"> </span><span class="dv">100</span><span class="co">#the size of skewness samples</span></a>
<a class="sourceLine" id="cb16-3" title="3">N &lt;-<span class="st"> </span><span class="dv">100</span><span class="co">#the number of simulations</span></a>
<a class="sourceLine" id="cb16-4" title="4">qua &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)<span class="co">#the vecter of quantiles</span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="kw">set.seed</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb16-6" title="6">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="co"># compute the sample skewness coeff</span></a>
<a class="sourceLine" id="cb16-7" title="7">  xmean &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb16-8" title="8">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xmean)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb16-9" title="9">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xmean)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb16-10" title="10">  m3<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb16-11" title="11">}</a>
<a class="sourceLine" id="cb16-12" title="12">q1 &lt;-<span class="st"> </span>q2 &lt;-<span class="st"> </span>q3 &lt;-<span class="st"> </span>q4 &lt;-<span class="kw">numeric</span>(N)<span class="co"># to storage the 0.025,0.05,0.95 and 0.975 quantiles of the skewness</span></a>
<a class="sourceLine" id="cb16-13" title="13">skw &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)<span class="co"># to storage the skewness of the samples</span></a>
<a class="sourceLine" id="cb16-14" title="14"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb16-15" title="15">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb16-16" title="16">    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb16-17" title="17">    skw[j] &lt;-<span class="st"> </span><span class="kw">sk</span>(x)</a>
<a class="sourceLine" id="cb16-18" title="18">  }</a>
<a class="sourceLine" id="cb16-19" title="19">  q &lt;-<span class="st"> </span><span class="kw">quantile</span>(skw,qua,<span class="dt">names =</span> F)<span class="co">#find the quantiles</span></a>
<a class="sourceLine" id="cb16-20" title="20">  q1[i] &lt;-<span class="st"> </span>q[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb16-21" title="21">  q2[i] &lt;-<span class="st"> </span>q[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb16-22" title="22">  q3[i] &lt;-<span class="st"> </span>q[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb16-23" title="23">  q4[i] &lt;-<span class="st"> </span>q[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb16-24" title="24">}</a>
<a class="sourceLine" id="cb16-25" title="25">q.hat &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb16-26" title="26">q.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(q1)<span class="co">#0.025 quantile estimate</span></a>
<a class="sourceLine" id="cb16-27" title="27">q.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(q2)<span class="co">#0.05 quantile estimate</span></a>
<a class="sourceLine" id="cb16-28" title="28">q.hat[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(q3)<span class="co">#0.95 quantile estimate</span></a>
<a class="sourceLine" id="cb16-29" title="29">q.hat[<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(q4)<span class="co">#0.975 quantile estimate</span></a>
<a class="sourceLine" id="cb16-30" title="30">q.hat<span class="co">#the estimates of such quantiles</span></a></code></pre></div>
<pre><code>## [1] -0.4453413 -0.3781042  0.3857467  0.4548685</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">qua.var &lt;-<span class="st"> </span><span class="cf">function</span>(q, n){<span class="co">#the 2.14 formula</span></a>
<a class="sourceLine" id="cb18-2" title="2">  xq &lt;-<span class="st"> </span><span class="kw">qnorm</span>(q, <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb18-3" title="3">  q<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>q)<span class="op">/</span>(n<span class="op">*</span><span class="kw">dnorm</span>(xq, <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-4" title="4">}</a>
<a class="sourceLine" id="cb18-5" title="5">q.sd &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">4</span>)<span class="co"># to storage the standard error</span></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb18-7" title="7">  q.sd[i] &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">qua.var</span>(qua[i], n))</a>
<a class="sourceLine" id="cb18-8" title="8">}</a>
<a class="sourceLine" id="cb18-9" title="9">q.sd<span class="co"># the standard error of the estimates from 2.14</span></a></code></pre></div>
<pre><code>## [1] 0.06350878 0.05023974 0.05023974 0.06350878</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">q.large &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb20-3" title="3">  q.large[i] &lt;-<span class="st"> </span><span class="kw">qnorm</span>(qua[i], <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))</a>
<a class="sourceLine" id="cb20-4" title="4">}</a>
<a class="sourceLine" id="cb20-5" title="5">q.large<span class="co"># the estimates of quantiles with the large sample approximation</span></a></code></pre></div>
<pre><code>## [1] -0.4800912 -0.4029052  0.4029052  0.4800912</code></pre>
<p>We find that when n=100, the estimates by Monte Carlo experiment are not too familiar to the estimates by the large sample approximation. That is because n is not large enough, next we will give the result when n=1000.</p>
<p>n=1000:</p>
<pre><code>## [1] -0.1434881 -0.1216992  0.1235820  0.1469126</code></pre>
<pre><code>## [1] -0.1518182 -0.1274098  0.1274098  0.1518182</code></pre>
<p>We find that when n=1000 the estimates by two methods are more close to each other, because n is large enough.</p>
<p>Homework 4</p>
<p>exercise 6.7</p>
<p>Estimate the power of the skewness test of normality against symmetric Beta(<span class="math inline">\(\alpha\)</span>,<span class="math inline">\(\alpha\)</span>) distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span> <span class="co">#the significance level</span></a>
<a class="sourceLine" id="cb24-2" title="2">n &lt;-<span class="st"> </span><span class="dv">100</span> <span class="co">#the size of samples</span></a>
<a class="sourceLine" id="cb24-3" title="3">m &lt;-<span class="st"> </span><span class="dv">2000</span> <span class="co">#the number of replicates</span></a>
<a class="sourceLine" id="cb24-4" title="4">a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.5</span>) <span class="co">#the alphas of beta distributions</span></a>
<a class="sourceLine" id="cb24-5" title="5">N &lt;-<span class="st"> </span><span class="kw">length</span>(a)</a>
<a class="sourceLine" id="cb24-6" title="6">pwr.beta &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb24-7" title="7"><span class="kw">set.seed</span>(<span class="dv">99</span>)</a>
<a class="sourceLine" id="cb24-8" title="8"></a>
<a class="sourceLine" id="cb24-9" title="9">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="co"># compute the sample skewness coeff</span></a>
<a class="sourceLine" id="cb24-10" title="10">  xmean &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb24-11" title="11">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xmean)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb24-12" title="12">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xmean)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb24-13" title="13">  m3<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb24-14" title="14">}</a>
<a class="sourceLine" id="cb24-15" title="15"></a>
<a class="sourceLine" id="cb24-16" title="16">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>)))) <span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb24-17" title="17"></a>
<a class="sourceLine" id="cb24-18" title="18"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb24-19" title="19">  ai &lt;-<span class="st"> </span>a[i]</a>
<a class="sourceLine" id="cb24-20" title="20">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb24-21" title="21">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb24-22" title="22">    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, ai, ai)</a>
<a class="sourceLine" id="cb24-23" title="23">    sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb24-24" title="24">  }</a>
<a class="sourceLine" id="cb24-25" title="25">  pwr.beta[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb24-26" title="26">}</a>
<a class="sourceLine" id="cb24-27" title="27"></a>
<a class="sourceLine" id="cb24-28" title="28"><span class="kw">plot</span>(a, pwr.beta, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="kw">bquote</span>(alpha), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb24-29" title="29"><span class="kw">abline</span>(<span class="dt">h =</span><span class="fl">0.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb24-30" title="30">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr.beta<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pwr.beta)<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb24-31" title="31"><span class="kw">lines</span>(a, pwr.beta<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb24-32" title="32"><span class="kw">lines</span>(a, pwr.beta<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">v &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">20</span> <span class="co">#the vs of t distributions</span></a>
<a class="sourceLine" id="cb25-2" title="2">N &lt;-<span class="st"> </span><span class="kw">length</span>(v)</a>
<a class="sourceLine" id="cb25-3" title="3">pwr.t &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb25-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb25-5" title="5">  vi &lt;-<span class="st"> </span>v[i]</a>
<a class="sourceLine" id="cb25-6" title="6">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb25-7" title="7">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb25-8" title="8">    x &lt;-<span class="st"> </span><span class="kw">rt</span>(n, vi)</a>
<a class="sourceLine" id="cb25-9" title="9">    sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb25-10" title="10">  }</a>
<a class="sourceLine" id="cb25-11" title="11">  pwr.t[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb25-12" title="12">}</a>
<a class="sourceLine" id="cb25-13" title="13"></a>
<a class="sourceLine" id="cb25-14" title="14"><span class="kw">plot</span>(v, pwr.t, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="kw">bquote</span>(v), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb25-15" title="15"><span class="kw">abline</span>(<span class="dt">h =</span><span class="fl">0.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb25-16" title="16">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr.t<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pwr.t)<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb25-17" title="17"><span class="kw">lines</span>(v, pwr.t<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb25-18" title="18"><span class="kw">lines</span>(v, pwr.t<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As the first figure show, when we use the symmetric Beta distributions to estimate the power of the skweness test of normality, the power is really small so that the result is very bad, we’d better not use them to do this test. However, when we use t(v) distributions, when v is small the power is large and the power gets smaller when v gets larger, that’s because when v is large enough, the limit distribution of t(v) is normal distrbution, so we use the heavy-tailed symmetric alternatives such as t(v)(when v is small) to do this test is better.</p>
<p>exercise 6.A</p>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level α, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) χ2(1), (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test H0 : μ = μ0 vs H1 : μ != μ0, where μ0 is the mean of χ2(1), Uniform(0,2), and Exponential(1), respectively.</p>
<ul>
<li><ol style="list-style-type: lower-roman">
<li>χ2(1)</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span> <span class="co">#the size of samples</span></a>
<a class="sourceLine" id="cb26-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span> <span class="co">#the significance level</span></a>
<a class="sourceLine" id="cb26-3" title="3">mu0 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co">#the mean of the chisq(1)</span></a>
<a class="sourceLine" id="cb26-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#the number of replicates</span></a>
<a class="sourceLine" id="cb26-5" title="5">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#the storage for p-values</span></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="kw">set.seed</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb26-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb26-8" title="8">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, mu0)</a>
<a class="sourceLine" id="cb26-9" title="9">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x,<span class="dt">mu =</span> mu0)</a>
<a class="sourceLine" id="cb26-10" title="10">  p[i] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb26-11" title="11">}</a>
<a class="sourceLine" id="cb26-12" title="12"></a>
<a class="sourceLine" id="cb26-13" title="13">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb26-14" title="14">se.hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p.hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p.hat)<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb26-15" title="15"><span class="kw">print</span>(<span class="kw">c</span>(p.hat, se.hat))</a></code></pre></div>
<pre><code>## [1] 0.108800000 0.003113881</code></pre>
<ul>
<li><ol start="2" style="list-style-type: lower-roman">
<li>Uniform(0,2)</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span> <span class="co">#the size of samples</span></a>
<a class="sourceLine" id="cb28-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span> <span class="co">#the significance level</span></a>
<a class="sourceLine" id="cb28-3" title="3">mu0 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co">#the mean of the U(0, 2)</span></a>
<a class="sourceLine" id="cb28-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#the number of replicates</span></a>
<a class="sourceLine" id="cb28-5" title="5">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#the storage for p-values</span></a>
<a class="sourceLine" id="cb28-6" title="6"><span class="kw">set.seed</span>(<span class="dv">19</span>)</a>
<a class="sourceLine" id="cb28-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb28-8" title="8">  x &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb28-9" title="9">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu =</span> mu0)</a>
<a class="sourceLine" id="cb28-10" title="10">  p[i] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb28-11" title="11">}</a>
<a class="sourceLine" id="cb28-12" title="12"></a>
<a class="sourceLine" id="cb28-13" title="13">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p<span class="op">&lt;=</span>alpha)</a>
<a class="sourceLine" id="cb28-14" title="14">se.hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p.hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p.hat)<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb28-15" title="15"><span class="kw">print</span>(<span class="kw">c</span>(p.hat, se.hat))</a></code></pre></div>
<pre><code>## [1] 0.053700000 0.002254247</code></pre>
<ul>
<li><ol start="3" style="list-style-type: lower-roman">
<li>Exponential(rate=1)</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span> <span class="co">#the size of samples</span></a>
<a class="sourceLine" id="cb30-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span> <span class="co">#the significance level</span></a>
<a class="sourceLine" id="cb30-3" title="3">mu0 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co">#the mean of the E(1)</span></a>
<a class="sourceLine" id="cb30-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#the number of replicates</span></a>
<a class="sourceLine" id="cb30-5" title="5">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#the storage for p-values</span></a>
<a class="sourceLine" id="cb30-6" title="6"><span class="kw">set.seed</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb30-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb30-8" title="8">  x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n)</a>
<a class="sourceLine" id="cb30-9" title="9">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu =</span> mu0)</a>
<a class="sourceLine" id="cb30-10" title="10">  p[i] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb30-11" title="11">}</a>
<a class="sourceLine" id="cb30-12" title="12"></a>
<a class="sourceLine" id="cb30-13" title="13">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p<span class="op">&lt;=</span>alpha)</a>
<a class="sourceLine" id="cb30-14" title="14">se.hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p.hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p.hat)<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb30-15" title="15"><span class="kw">print</span>(<span class="kw">c</span>(p.hat, se.hat))</a></code></pre></div>
<pre><code>## [1] 0.083500000 0.002766365</code></pre>
<p>As the results above show, only the oberserved type I error rate of U(0,2) is about 0.05, the other two results is less than 0.05, and all the standard errors is small enough.</p>
<p>Homework 5</p>
<p>exercise 7.6</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb32-2" title="2">score &lt;-<span class="st"> </span>scor <span class="co">#store the scor data into score</span></a>
<a class="sourceLine" id="cb32-3" title="3"><span class="kw">pairs</span>(score[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]) <span class="co">#the scatter plots for each pair of test scores</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">cormatrix &lt;-<span class="st"> </span><span class="kw">cor</span>(score) <span class="co">#the sample correlation matrix</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="kw">round</span>(cormatrix, <span class="dv">2</span>)</a></code></pre></div>
<pre><code>##      mec  vec  alg  ana  sta
## mec 1.00 0.55 0.55 0.41 0.39
## vec 0.55 1.00 0.61 0.49 0.44
## alg 0.55 0.61 1.00 0.71 0.66
## ana 0.41 0.49 0.71 1.00 0.61
## sta 0.39 0.44 0.66 0.61 1.00</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">r &lt;-<span class="st"> </span><span class="cf">function</span>(x, i){ <span class="co">#the correlation of columns 1 and 2</span></a>
<a class="sourceLine" id="cb35-2" title="2">  <span class="kw">cor</span>(x[i, <span class="dv">1</span>], x[i, <span class="dv">2</span>])</a>
<a class="sourceLine" id="cb35-3" title="3">}</a>
<a class="sourceLine" id="cb35-4" title="4"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb35-5" title="5"><span class="kw">set.seed</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb35-6" title="6">boot.sd &lt;-<span class="st"> </span><span class="cf">function</span>(i, j){ <span class="co">#bootstrap estimates of the standard error</span></a>
<a class="sourceLine" id="cb35-7" title="7">  obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> score[,<span class="kw">c</span>(i,j)], <span class="dt">statistic =</span> r, <span class="dt">R =</span> <span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb35-8" title="8">  <span class="kw">sd</span>(obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb35-9" title="9">}</a>
<a class="sourceLine" id="cb35-10" title="10">rho12 &lt;-<span class="st"> </span><span class="kw">boot.sd</span>(<span class="dv">1</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb35-11" title="11">rho34 &lt;-<span class="st"> </span><span class="kw">boot.sd</span>(<span class="dv">3</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb35-12" title="12">rho35 &lt;-<span class="st"> </span><span class="kw">boot.sd</span>(<span class="dv">3</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb35-13" title="13">rho45 &lt;-<span class="st"> </span><span class="kw">boot.sd</span>(<span class="dv">4</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb35-14" title="14"><span class="kw">round</span>(<span class="kw">c</span>(rho12, rho34, rho35, rho45), <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 0.076 0.048 0.059 0.067</code></pre>
<p>From the panel display of the scartter plots for each pair of test scores, I think (1, 2), (1, 3), (2, 3), (3, 4), (3, 5), (4, 5) pairs of test scores may have some linear relationship, and the (3, 4) pair may have the strongest linear relationship. After compare the correlation matrix, we find that our observation is almost true. At last we give the bootstrap estimates of standard errors of <span class="math inline">\(\hat\rho_{12},\hat\rho_{34},\hat\rho_{35},\hat\rho_{45}\)</span>, and we can know the estimate of the standard error of <span class="math inline">\(\hat\rho_{34}\)</span> is the smallest, this can also prove our opinion.</p>
<p>exercise 7.B</p>
<p>First we can caculate the skewness of <span class="math inline">\(\chi^2(5)\)</span> : <span class="math inline">\(\operatorname{sk}\left(\chi^{2}(5)\right)=\int\left(\frac{x-5}{\sqrt{10}}\right)^{3} \cdot f(x) d x=\sqrt{\frac{8}{5}}\)</span></p>
<ul>
<li>Normal:</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb37-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span> <span class="co">#sample size</span></a>
<a class="sourceLine" id="cb37-3" title="3">N &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb37-4" title="4">sk &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb37-5" title="5"><span class="kw">set.seed</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb37-6" title="6"></a>
<a class="sourceLine" id="cb37-7" title="7">ski &lt;-<span class="st"> </span><span class="cf">function</span>(x, i){<span class="co"># compute the sample skewness coeff</span></a>
<a class="sourceLine" id="cb37-8" title="8">  xmean &lt;-<span class="st"> </span><span class="kw">mean</span>(x[i])</a>
<a class="sourceLine" id="cb37-9" title="9">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i]<span class="op">-</span>xmean)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb37-10" title="10">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i]<span class="op">-</span>xmean)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb37-11" title="11">  m3<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb37-12" title="12">}</a>
<a class="sourceLine" id="cb37-13" title="13"></a>
<a class="sourceLine" id="cb37-14" title="14">ci.norm &lt;-<span class="st"> </span>ci.basic &lt;-<span class="st"> </span>ci.perc &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, N, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb37-15" title="15"></a>
<a class="sourceLine" id="cb37-16" title="16"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb37-17" title="17">  sam &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb37-18" title="18">  de &lt;-<span class="st"> </span><span class="kw">boot</span>(sam, <span class="dt">statistic =</span> ski, <span class="dt">R =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb37-19" title="19">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb37-20" title="20">  ci.norm[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb37-21" title="21">  ci.basic[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb37-22" title="22">  ci.perc[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb37-23" title="23">}</a>
<a class="sourceLine" id="cb37-24" title="24"><span class="kw">cat</span>(<span class="st">&#39;norm: cover rate = &#39;</span>, <span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk), <span class="st">&#39;, missing rate left = &#39;</span>, <span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;</span>sk), <span class="st">&#39;, missing rate right = &#39;</span>, <span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;</span>sk)) <span class="co">#norm</span></a></code></pre></div>
<pre><code>## norm: cover rate =  0.904 , missing rate left =  0.052 , missing rate right =  0.044</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;basic: cover rate = &#39;</span>, <span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk), <span class="st">&#39;, missing rate left = &#39;</span>, <span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;</span>sk), <span class="st">&#39;, missing rate right = &#39;</span>, <span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;</span>sk)) <span class="co">#basic</span></a></code></pre></div>
<pre><code>## basic: cover rate =  0.897 , missing rate left =  0.056 , missing rate right =  0.047</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;perc: cover rate = &#39;</span>, <span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk), <span class="st">&#39;, missing rate left = &#39;</span>, <span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;</span>sk), <span class="st">&#39;, missing rate right = &#39;</span>, <span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;</span>sk)) <span class="co">#perc</span></a></code></pre></div>
<pre><code>## perc: cover rate =  0.976 , missing rate left =  0.009 , missing rate right =  0.015</code></pre>
<ul>
<li><span class="math inline">\(\chi^2(5)\)</span></li>
</ul>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span> <span class="co">#sample size</span></a>
<a class="sourceLine" id="cb43-2" title="2">N &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb43-3" title="3">sk &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb43-4" title="4"><span class="kw">set.seed</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb43-5" title="5"></a>
<a class="sourceLine" id="cb43-6" title="6">ski &lt;-<span class="st"> </span><span class="cf">function</span>(x, i){<span class="co"># compute the sample skewness coeff</span></a>
<a class="sourceLine" id="cb43-7" title="7">  xmean &lt;-<span class="st"> </span><span class="kw">mean</span>(x[i])</a>
<a class="sourceLine" id="cb43-8" title="8">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i]<span class="op">-</span>xmean)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb43-9" title="9">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i]<span class="op">-</span>xmean)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb43-10" title="10">  m3<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb43-11" title="11">}</a>
<a class="sourceLine" id="cb43-12" title="12"></a>
<a class="sourceLine" id="cb43-13" title="13">ci.norm &lt;-<span class="st"> </span>ci.basic &lt;-<span class="st"> </span>ci.perc &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, N, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb43-14" title="14"></a>
<a class="sourceLine" id="cb43-15" title="15"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb43-16" title="16">  sam &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb43-17" title="17">  de &lt;-<span class="st"> </span><span class="kw">boot</span>(sam, <span class="dt">statistic =</span> ski, <span class="dt">R =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb43-18" title="18">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb43-19" title="19">  ci.norm[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb43-20" title="20">  ci.basic[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb43-21" title="21">  ci.perc[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb43-22" title="22">}</a>
<a class="sourceLine" id="cb43-23" title="23"><span class="kw">cat</span>(<span class="st">&#39;norm: cover rate = &#39;</span>, <span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk), <span class="st">&#39;, missing rate left = &#39;</span>, <span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;</span>sk), <span class="st">&#39;, missing rate right = &#39;</span>, <span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;</span>sk)) <span class="co">#norm</span></a></code></pre></div>
<pre><code>## norm: cover rate =  0.712 , missing rate left =  0.021 , missing rate right =  0.267</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;basic: cover rate = &#39;</span>, <span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk), <span class="st">&#39;, missing rate left = &#39;</span>, <span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;</span>sk), <span class="st">&#39;, missing rate right = &#39;</span>, <span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;</span>sk)) <span class="co">#basic</span></a></code></pre></div>
<pre><code>## basic: cover rate =  0.69 , missing rate left =  0.035 , missing rate right =  0.275</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;perc: cover rate = &#39;</span>, <span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk), <span class="st">&#39;, missing rate left = &#39;</span>, <span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;</span>sk), <span class="st">&#39;, missing rate right = &#39;</span>, <span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;</span>sk)) <span class="co">#perc</span></a></code></pre></div>
<pre><code>## perc: cover rate =  0.704 , missing rate left =  0 , missing rate right =  0.296</code></pre>
<p>As we show, we can find that the percentile confidence interval is better than the other two intervals, and the coverage rate for normal population is larger (around 0.9) than <span class="math inline">\(\chi^2(5)\)</span> (around 0.7) distribution.</p>
<p>Homework 6</p>
<p>exercise 7.8</p>
<p>Refer to exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
<p>As we know, the MLE of <span class="math inline">\(\Sigma\)</span> is <span class="math inline">\(\frac{1}{n}\Sigma_{i=1}^{n}(x_i-\bar x)(x_i-\bar x)^T\)</span>, so when we caculate it we need to use <span class="math inline">\(\frac{n-1}{n}cov\)</span>.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb49-2" title="2">score &lt;-<span class="st"> </span>scor <span class="co">#store the scor data into score</span></a>
<a class="sourceLine" id="cb49-3" title="3">pca1 &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb49-4" title="4">  m &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</a>
<a class="sourceLine" id="cb49-5" title="5">  covmatrix &lt;-<span class="st"> </span>(m<span class="dv">-1</span>)<span class="op">/</span>m<span class="op">*</span><span class="kw">cov</span>(x) <span class="co">#MLE of Sigma</span></a>
<a class="sourceLine" id="cb49-6" title="6">  <span class="kw">eigen</span>(covmatrix)<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(<span class="kw">eigen</span>(covmatrix)<span class="op">$</span>values) <span class="co">#the proportion of first principle component</span></a>
<a class="sourceLine" id="cb49-7" title="7">}</a>
<a class="sourceLine" id="cb49-8" title="8">theta.hat &lt;-<span class="st"> </span><span class="kw">pca1</span>(score)</a>
<a class="sourceLine" id="cb49-9" title="9">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(score)</a>
<a class="sourceLine" id="cb49-10" title="10">theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb49-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb49-12" title="12">  theta.jack[i] &lt;-<span class="st"> </span><span class="kw">pca1</span>(score[<span class="op">-</span>i,])</a>
<a class="sourceLine" id="cb49-13" title="13">}</a>
<a class="sourceLine" id="cb49-14" title="14">bias.jack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat) <span class="co">#bias</span></a>
<a class="sourceLine" id="cb49-15" title="15">se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>)) <span class="co">#standard error</span></a>
<a class="sourceLine" id="cb49-16" title="16"><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original =</span> theta.hat, <span class="dt">bias.jack =</span> bias.jack, <span class="dt">se.jack =</span> se.jack),<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
<p>As we show, the jackknife estimates of <span class="math inline">\(\theta\)</span>, bias, standard error of <span class="math inline">\(\hat\theta\)</span> are 0.619, 0.001, 0.050.</p>
<p>exercise 7.10</p>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^2\)</span>?</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="kw">library</span>(DAAG)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">attach</span>(ironslag)</a>
<a class="sourceLine" id="cb55-2" title="2">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic)</a>
<a class="sourceLine" id="cb55-3" title="3">e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb55-4" title="4"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb55-5" title="5">  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb55-6" title="6">  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb55-7" title="7">  </a>
<a class="sourceLine" id="cb55-8" title="8">  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb55-9" title="9">  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb55-10" title="10">  e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb55-11" title="11">  </a>
<a class="sourceLine" id="cb55-12" title="12">  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb55-13" title="13">  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></a>
<a class="sourceLine" id="cb55-14" title="14"><span class="st">  </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb55-15" title="15">  e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb55-16" title="16">  </a>
<a class="sourceLine" id="cb55-17" title="17">  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb55-18" title="18">  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb55-19" title="19">  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb55-20" title="20">  e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</a>
<a class="sourceLine" id="cb55-21" title="21"></a>
<a class="sourceLine" id="cb55-22" title="22">  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb55-23" title="23">  yhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></a>
<a class="sourceLine" id="cb55-24" title="24"><span class="st">  </span>J4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span>J4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb55-25" title="25">  e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</a>
<a class="sourceLine" id="cb55-26" title="26">}</a>
<a class="sourceLine" id="cb55-27" title="27"><span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</a></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">summary</span>(J1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.5784 -2.3022 -0.0203  2.1964 11.9740 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   1.7881     2.5077   0.713    0.479    
## x             0.8895     0.1159   7.678 5.25e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.188 on 50 degrees of freedom
## Multiple R-squared:  0.5411, Adjusted R-squared:  0.5319 
## F-statistic: 58.95 on 1 and 50 DF,  p-value: 5.249e-10</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw">summary</span>(J2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.2243 -2.4454 -0.1374  2.2346 12.5821 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) 25.98525    8.75932   2.967  0.00464 **
## x           -1.52948    0.85065  -1.798  0.07834 . 
## I(x^2)       0.05707    0.01991   2.867  0.00609 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.915 on 49 degrees of freedom
## Multiple R-squared:  0.607,  Adjusted R-squared:  0.591 
## F-statistic: 37.84 on 2 and 49 DF,  p-value: 1.154e-10</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">summary</span>(J3)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(y) ~ x)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.63621 -0.08603 -0.00391  0.10665  0.44188 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.127402   0.115186  18.469  &lt; 2e-16 ***
## x           0.040570   0.005321   7.624 6.37e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1924 on 50 degrees of freedom
## Multiple R-squared:  0.5376, Adjusted R-squared:  0.5283 
## F-statistic: 58.13 on 1 and 50 DF,  p-value: 6.371e-10</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">summary</span>(J4)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2) + I(x^3))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.4347 -2.0627 -0.3247  2.2127 13.1177 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) -2.763718  26.402670  -0.105    0.917
## x            2.908468   3.938834   0.738    0.464
## I(x^2)      -0.160916   0.189976  -0.847    0.401
## I(x^3)       0.003424   0.002968   1.154    0.254
## 
## Residual standard error: 3.902 on 48 degrees of freedom
## Multiple R-squared:  0.6176, Adjusted R-squared:  0.5937 
## F-statistic: 25.84 on 3 and 48 DF,  p-value: 4.264e-10</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">detach</span>(ironslag)</a></code></pre></div>
<p>As we show, the Quadratic model is selected by the cross validation procedure since it’s mean squared error is the least. According to the maximum adjusted <span class="math inline">\(R^2\)</span>, the maximum adjusted <span class="math inline">\(R^2\)</span> are 0.5319, 0.591, 0.5283, 0.5937, so we choose the maximum that is the Cubic polynomial model.</p>
<p>Homework 7</p>
<p>exercise 8.3</p>
<p>We need use the permutation to find what the count number be the test criterion looks reasonable for two different size samples from normal distribution.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">maxout &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb66-2" title="2">X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb66-3" title="3">Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb66-4" title="4">outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb66-5" title="5">outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb66-6" title="6"><span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</a>
<a class="sourceLine" id="cb66-7" title="7">}</a>
<a class="sourceLine" id="cb66-8" title="8"></a>
<a class="sourceLine" id="cb66-9" title="9">n1 &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb66-10" title="10">n2 &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb66-11" title="11">mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb66-12" title="12">sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb66-13" title="13">m &lt;-<span class="st"> </span><span class="dv">100</span> <span class="co">#times of replicates</span></a>
<a class="sourceLine" id="cb66-14" title="14">R &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#times of permutations</span></a>
<a class="sourceLine" id="cb66-15" title="15"><span class="kw">set.seed</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb66-16" title="16">stat &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb66-17" title="17">K &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">50</span></a>
<a class="sourceLine" id="cb66-18" title="18">reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)</a>
<a class="sourceLine" id="cb66-19" title="19"></a>
<a class="sourceLine" id="cb66-20" title="20"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb66-21" title="21">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</a>
<a class="sourceLine" id="cb66-22" title="22">  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</a>
<a class="sourceLine" id="cb66-23" title="23">  z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</a>
<a class="sourceLine" id="cb66-24" title="24">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</a>
<a class="sourceLine" id="cb66-25" title="25">    k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> n1, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb66-26" title="26">    x &lt;-<span class="st"> </span>z[k];y &lt;-z[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb66-27" title="27">    reps[j] &lt;-<span class="st"> </span><span class="kw">maxout</span>(x,y)</a>
<a class="sourceLine" id="cb66-28" title="28">  }</a>
<a class="sourceLine" id="cb66-29" title="29">  stat[i] &lt;-<span class="st"> </span><span class="kw">quantile</span>(reps,<span class="fl">0.95</span>)</a>
<a class="sourceLine" id="cb66-30" title="30">}</a>
<a class="sourceLine" id="cb66-31" title="31"><span class="kw">mean</span>(stat)</a></code></pre></div>
<pre><code>## [1] 6.822</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">count7test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb68-2" title="2">X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb68-3" title="3">Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb68-4" title="4">outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb68-5" title="5">outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb68-6" title="6"><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></a>
<a class="sourceLine" id="cb68-7" title="7"><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>))</a>
<a class="sourceLine" id="cb68-8" title="8">}</a>
<a class="sourceLine" id="cb68-9" title="9">tests &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb68-10" title="10">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</a>
<a class="sourceLine" id="cb68-11" title="11">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</a>
<a class="sourceLine" id="cb68-12" title="12">x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#centered by sample mean</span></a>
<a class="sourceLine" id="cb68-13" title="13">y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb68-14" title="14"><span class="kw">count7test</span>(x, y)</a>
<a class="sourceLine" id="cb68-15" title="15">} )</a>
<a class="sourceLine" id="cb68-16" title="16">alphahat &lt;-<span class="st"> </span><span class="kw">mean</span>(tests) <span class="co">#type I error</span></a>
<a class="sourceLine" id="cb68-17" title="17"><span class="kw">print</span>(alphahat)</a></code></pre></div>
<pre><code>## [1] 0.02</code></pre>
<p>As we show, we use permutation to find that we’d better use “count 7” to do the test when n1=20, n2=30, then we have that the type I error rate is 0.02, it meets our requirment.</p>
<p>slide 31</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb70-2" title="2"><span class="kw">library</span>(MASS)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb73-2" title="2">dCov &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb73-3" title="3">x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x); y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(y)</a>
<a class="sourceLine" id="cb73-4" title="4">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x); m &lt;-<span class="st"> </span><span class="kw">nrow</span>(y)</a>
<a class="sourceLine" id="cb73-5" title="5"><span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span>m <span class="op">||</span><span class="st"> </span>n <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>)</a>
<a class="sourceLine" id="cb73-6" title="6"><span class="cf">if</span> (<span class="op">!</span><span class="st"> </span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y)))))</a>
<a class="sourceLine" id="cb73-7" title="7"><span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</a>
<a class="sourceLine" id="cb73-8" title="8">Akl &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb73-9" title="9">d &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</a>
<a class="sourceLine" id="cb73-10" title="10">m &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(d); M &lt;-<span class="st"> </span><span class="kw">mean</span>(d)</a>
<a class="sourceLine" id="cb73-11" title="11">a &lt;-<span class="st"> </span><span class="kw">sweep</span>(d, <span class="dv">1</span>, m); b &lt;-<span class="st"> </span><span class="kw">sweep</span>(a, <span class="dv">2</span>, m)</a>
<a class="sourceLine" id="cb73-12" title="12">b <span class="op">+</span><span class="st"> </span>M</a>
<a class="sourceLine" id="cb73-13" title="13">}</a>
<a class="sourceLine" id="cb73-14" title="14">A&lt;-<span class="st"> </span><span class="kw">Akl</span>(x); B &lt;-<span class="st"> </span><span class="kw">Akl</span>(y)</a>
<a class="sourceLine" id="cb73-15" title="15"><span class="kw">sqrt</span>(<span class="kw">mean</span>(A <span class="op">*</span><span class="st"> </span>B))</a>
<a class="sourceLine" id="cb73-16" title="16">}</a>
<a class="sourceLine" id="cb73-17" title="17">ndCov2 &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, dims) {</a>
<a class="sourceLine" id="cb73-18" title="18"><span class="co">#dims contains dimensions of x and y</span></a>
<a class="sourceLine" id="cb73-19" title="19">p &lt;-<span class="st"> </span>dims[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb73-20" title="20">q &lt;-<span class="st"> </span>dims[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb73-21" title="21">d &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span>q</a>
<a class="sourceLine" id="cb73-22" title="22">x &lt;-<span class="st"> </span>z[ , <span class="dv">1</span><span class="op">:</span>p] <span class="co">#leave x as is</span></a>
<a class="sourceLine" id="cb73-23" title="23">y &lt;-<span class="st"> </span>z[ix, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>p)] <span class="co">#permute rows of y</span></a>
<a class="sourceLine" id="cb73-24" title="24"><span class="kw">return</span>(<span class="kw">nrow</span>(z) <span class="op">*</span><span class="st"> </span><span class="kw">dCov</span>(x, y)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb73-25" title="25">}</a>
<a class="sourceLine" id="cb73-26" title="26"><span class="kw">set.seed</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb73-27" title="27">n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>)</a>
<a class="sourceLine" id="cb73-28" title="28">m &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb73-29" title="29">power.cor1 &lt;-<span class="st"> </span>power.ball1 &lt;-<span class="st"> </span>power.cor2 &lt;-<span class="st"> </span>power.ball2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb73-30" title="30">p.cor1 &lt;-<span class="st"> </span>p.ball1 &lt;-<span class="st"> </span>p.cor2 &lt;-<span class="st"> </span>p.ball2 &lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb73-31" title="31">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb73-32" title="32"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb73-33" title="33"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb73-34" title="34">I &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb73-35" title="35">X &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n[j],<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),I)</a>
<a class="sourceLine" id="cb73-36" title="36">E &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n[j],<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),I)</a>
<a class="sourceLine" id="cb73-37" title="37">X &lt;-<span class="st"> </span>X<span class="op">/</span><span class="dv">4</span></a>
<a class="sourceLine" id="cb73-38" title="38">Y1 &lt;-<span class="st"> </span>X<span class="op">+</span>E <span class="co">#model1</span></a>
<a class="sourceLine" id="cb73-39" title="39">Y2 &lt;-<span class="st"> </span>X <span class="op">*</span><span class="st"> </span>E <span class="co">#model2</span></a>
<a class="sourceLine" id="cb73-40" title="40">Z1 &lt;-<span class="st"> </span><span class="kw">cbind</span>(X, Y1)</a>
<a class="sourceLine" id="cb73-41" title="41">Z2 &lt;-<span class="st"> </span><span class="kw">cbind</span>(X, Y2)</a>
<a class="sourceLine" id="cb73-42" title="42">boot.obj1 &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> Z1, <span class="dt">statistic =</span> ndCov2, <span class="dt">R=</span><span class="dv">100</span>, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>,<span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb73-43" title="43">boot.obj2 &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> Z2, <span class="dt">statistic =</span> ndCov2, <span class="dt">R=</span><span class="dv">100</span>, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>,<span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb73-44" title="44">tb1 &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj1<span class="op">$</span>t0, boot.obj1<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb73-45" title="45">p.cor1[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(tb1<span class="op">&gt;=</span>tb1[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb73-46" title="46">tb2 &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj2<span class="op">$</span>t0, boot.obj2<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb73-47" title="47">p.cor2[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(tb2<span class="op">&gt;=</span>tb2[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb73-48" title="48">p.ball1[i] &lt;-<span class="st"> </span><span class="kw">bcov.test</span>(X, Y1, <span class="dt">R =</span> <span class="dv">100</span>, <span class="dt">seed =</span> i<span class="op">*</span><span class="dv">123</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb73-49" title="49">p.ball2[i] &lt;-<span class="st"> </span><span class="kw">bcov.test</span>(X, Y2, <span class="dt">R =</span> <span class="dv">100</span>, <span class="dt">seed =</span> i<span class="op">*</span><span class="dv">123</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb73-50" title="50">}</a>
<a class="sourceLine" id="cb73-51" title="51">power.cor1[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(p.cor1<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb73-52" title="52">power.ball1[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(p.ball1<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb73-53" title="53">power.cor2[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(p.cor2<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb73-54" title="54">power.ball2[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(p.ball2<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb73-55" title="55">}</a>
<a class="sourceLine" id="cb73-56" title="56"></a>
<a class="sourceLine" id="cb73-57" title="57"><span class="kw">plot</span>(n,power.cor1,<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;power1&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">200</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>) , <span class="dt">col =</span> <span class="st">&quot;1&quot;</span>)</a>
<a class="sourceLine" id="cb73-58" title="58"><span class="kw">lines</span>(n,power.ball1,<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">col=</span><span class="st">&quot;2&quot;</span>)</a>
<a class="sourceLine" id="cb73-59" title="59"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">15</span>, <span class="dv">15</span>), <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;power.cor1&quot;</span>,<span class="st">&quot;power.ball1&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">plot</span>(n,power.cor2,<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;power2&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">200</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>) , <span class="dt">col =</span> <span class="st">&quot;1&quot;</span>)</a>
<a class="sourceLine" id="cb74-2" title="2"><span class="kw">lines</span>(n,power.ball2,<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">col=</span><span class="st">&quot;2&quot;</span>)</a>
<a class="sourceLine" id="cb74-3" title="3"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">15</span>, <span class="dv">15</span>), <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;power.cor2&quot;</span>,<span class="st">&quot;power.ball2&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a></code></pre></div>
<p>As we show, we can find that in model 1, the power of distance correlation test is higher than ball covariance test; in model 2, the condition is verse, and in the two model the powers are both getting larger as sample size become larger.</p>
<p>Homework 8</p>
<p>exercise 9.4</p>
</div>
<div id="section" class="section level2">
<h2>9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="kw">library</span>(GeneralizedHyperbolic)</a>
<a class="sourceLine" id="cb76-2" title="2">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</a>
<a class="sourceLine" id="cb76-3" title="3">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb76-4" title="4">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb76-5" title="5">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb76-6" title="6">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb76-7" title="7">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb76-8" title="8">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb76-9" title="9">    <span class="cf">if</span>(u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dskewlap</span>(y)<span class="op">/</span><span class="kw">dskewlap</span>(x[i<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb76-10" title="10">      x[i] &lt;-<span class="st"> </span>y</a>
<a class="sourceLine" id="cb76-11" title="11">    <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb76-12" title="12">      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb76-13" title="13">      k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb76-14" title="14">    }</a>
<a class="sourceLine" id="cb76-15" title="15">  }</a>
<a class="sourceLine" id="cb76-16" title="16">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb76-17" title="17">}</a>
<a class="sourceLine" id="cb76-18" title="18"></a>
<a class="sourceLine" id="cb76-19" title="19">N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb76-20" title="20">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb76-21" title="21"></a>
<a class="sourceLine" id="cb76-22" title="22">x0 &lt;-<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb76-23" title="23">rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb76-24" title="24">rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb76-25" title="25">rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb76-26" title="26">rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb76-27" title="27"></a>
<a class="sourceLine" id="cb76-28" title="28">no.reject &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sigma=</span>sigma,<span class="dt">no.reject=</span><span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k),<span class="dt">accept.rate=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>rw1<span class="op">$</span>k<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rw2<span class="op">$</span>k<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rw3<span class="op">$</span>k<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rw4<span class="op">$</span>k<span class="op">/</span>N))</a>
<a class="sourceLine" id="cb76-29" title="29">    knitr<span class="op">::</span><span class="kw">kable</span>(no.reject,<span class="dt">format=</span><span class="st">&#39;html&#39;</span>)</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
no.reject
</th>
<th style="text-align:right;">
accept.rate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
0.9825
</td>
</tr>
<tr>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
322
</td>
<td style="text-align:right;">
0.8390
</td>
</tr>
<tr>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:right;">
947
</td>
<td style="text-align:right;">
0.5265
</td>
</tr>
<tr>
<td style="text-align:right;">
16.00
</td>
<td style="text-align:right;">
1761
</td>
<td style="text-align:right;">
0.1195
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="co">#par(mfrow=c(2,2))  #display 4 graphs together</span></a>
<a class="sourceLine" id="cb77-2" title="2">refline &lt;-<span class="st"> </span><span class="kw">qskewlap</span>(<span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>))</a>
<a class="sourceLine" id="cb77-3" title="3">rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x,  rw4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb77-4" title="4"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb77-5" title="5">    <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb77-6" title="6">          <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</a>
<a class="sourceLine" id="cb77-7" title="7">          <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</a>
<a class="sourceLine" id="cb77-8" title="8">    <span class="kw">abline</span>(<span class="dt">h=</span>refline)</a>
<a class="sourceLine" id="cb77-9" title="9">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6ZpA6ZrY6kNtmAABmADpmOgBmZjpmZrZmtttmtv+QOgCQ2/+2ZgC2Zjq2Zma22/+2///bkDrbtpDb////tmb/25D//7b//9v///8ZM4qDAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHVklEQVR4nO2dC3vbJhSGT9qkuyRbuyTeFm+2w///k5OtCyABH/KOJCR9b5/6cazDAb1FgG2qiCFJZOkGlA4FASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgIoC5LVsJQg3XTTQUEACgIsLKh8TxQEoCAABQEoCEBBAAoCLCsofyG/GDML6r3FoSCUjoJAOgoC6SgIpKMgkI6CQDoKAukoCKSjIJCOgkA6CkLpijdEQQAKAlAQYNmPOygIpqMgkI6CQDoKAukoCKSjIJBun4IuL8/V46mazL98gHQ7FnT8+u/12Ws63X4FNWpumhLp9ivo/HQTdIpcZBTEHpTg8nJ9t/Vo2uE6kW6fgszN0cN7NZFF/FBQbjoK6mXhxx0j01EQSLdPQfUsVsN1UIjPt+ibsF66nQqqDD3mpduroGoFFHmX2ku3W0G56SgIpNuyoL/AOJyVbmuCLj/an89PaKLKqndzgl6qt6BXDvFPU0fVuzVB1fx9/Rjj/CRgGs+td3OCrhP4w3dp+tH/r3eDgppOpFTvBgUdrz3o3gFo+x93VO9DH2+PsY8KR9a7NUGcxUAg10EjArmSvi9wXDoKAukoCKS7I+28TilIqzYK0gocl2582pn/K/mGBSl9F6weOC7dPgVNukfRCgJlSxeks0dxeFxHkP55jxWktMNsu4LCexRHfx40vyDxj7MHhY9MLUhtj+I2BRm9PYpJQenCZQvKTScg8USCEjexLV1Qb/j2jooXsHFBq2EpQVZU/wUvwq1WYj0ocBYS7Hy2pPgvDFo2/nupSQWJbZGIq0bigsQVZMOsb09BTJB4L7cPUo6guiUijqBb46VufIYgaQSJuIntUVe37R89QX7QSgRJhiBpyvqCJChI7HnXldR/jXS9re3NJQqSMYKkU9Cepdij0h1t/rZlmzFXTPesFSRWUPenQEFty2y7pWuzM0z5gsQR1Ba3Ntxzd17xBHlPjdg8I897MkFGvOZ7gqy2ruXOJeWdcUyQBCsY1uc+8Xp0AYKCDe4LcM61XyIYmn4tK2QJQb3aY4LGndEdBhJFnH+OBQQN03W9Gp2md9Wkg3uDUKCAiWdwx7V1CDLdQsdpeqATeE7SgtqKjVfQ9B7LEGQ8Qc5UYqcYU09gzqm35+edmr1cjbPA8QU5S65umWC8elYkyF3aDQUZX5DpBJmooCamWzG7guwSu6uoJEHG9AQZK8iN8wSZgSBjnXQ9RexZ9wXVz5uHbp3aZSlMkAkI6hUJCbJr5ybGdKNLJ8heU8YRZMKCjPNar6HZZ6SBJ6h74jR2WJ+4ncCmGQpqc+QLcucMU5wg+1rbuoQgI4NDAUHGF2F6goYNkeFrUwrK+ep5NUwmKO+rZ19acyjcg4zJ6EHJSmJ5U+UmE5T5xeEoxgrKr3QBQZm3xxlFpAc4l8G9ghTKFNGDwgXzx4k769QNNKO+etZgfYJM9Kvn8ZNDBqsUNGe61Qr6fIv/nylVQYq57k9OQfqtoCDAXIImhYIAW5jFJoWCAIsJWg0LCRqXNDNukbA7w3WTUpBOHAWVGHZnuG5SCtKJo6ASw+4M101KQTpx2xO0JSgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBBAX9BJUreltpuwurh0gRTnnz60Uw5QF3S6brCKt+787b0XBwokuLzcdkpqphyiLaj+4v4QvXV3u/uzi0MF4pya/dqKKQNoC6p3wR6jO82Pj704VCDKSZ5rNXopQ6gLuvX32C7h6t/152q8eHbiUIEUdSnVlAO0BdWXfnQAuLxc9w8fnm0cKJCu7OpAN+WAmQU1QV8+9ATpphww9yVWBz29Kl5iqikHzD1I10Hf3lVGVFeQUsoBM0/zddurE1OZk2+CdFMOmHuheGt2NaKqrOqaWUwz5QD9txpHSS7zD9Wc/OrFgQIJmktMM+UAvlkFUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggCrEvT5Vm+2m5M1Cfp8e3g3R9HZ1pLLmgSpbozKZU2CarQ2/mRSoKDPP59u94iKDDaH3fegw9e/zflH+G7DJvErTKehPEHNHtVf658OzS3H2pH5NPMYXaCgel/d5bfgSDN3/ylYUPCu+cfZ/RQoqFbT3Brev8SOEvldAxNSnqBqHv+jWhMG7gl/fpq9/xQpyPzzu8gvgVnsWHem3a+DyoKCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgL8BxkqLnog/rVWAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="co">#par(mfrow=c(1,1)) #reset to default</span></a></code></pre></div>
<p>In the first plot of the Figure above with σ = 0.05, the ratios r(Xt, Y ) tend to be large and almost every candidate point is accepted. The increments are small and the chain is almost like a true random walk. Chain 1 has not converged to the target in 2000 iterations. The chain in the second plot generated with σ = 0.5 is converging very slowly and requires a much longer burn-in period. In the third plot (σ = 2) the chain is mixing well and converging to the target distribution after a short burn-in period of about 500. Finally, in the fourth plot, where σ = 16, the ratios r(Xt, Y ) are smaller and most of the candidate points are rejected. The fourth chain converges, but it is inefficient.</p>
<p>Homework 9</p>
<p>exercise 11.1</p>
<p>The natural logarithm and exponential functions are inverses of each other, so that mathematically log(exp x) = exp(logx) = x. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality? (See all.equal.)</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1">x &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb79-2" title="2">y &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="kw">exp</span>(x))</a>
<a class="sourceLine" id="cb79-3" title="3">z &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">log</span>(x))</a>
<a class="sourceLine" id="cb79-4" title="4">x<span class="op">==</span>y</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">x<span class="op">==</span>z</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1">y<span class="op">==</span>z</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="kw">all.equal</span>(x,y)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="kw">all.equal</span>(x,z)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="kw">all.equal</span>(y,z)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>As we show, <span class="math inline">\(x=\exp(\log x)\)</span> and <span class="math inline">\(\log(\exp x)=\exp(\log x)\)</span> do not hold exactly in computer arithmetic. However the identity holds with near equality.</p>
<p>exercise 11.5</p>
</div>
<div id="section-1" class="section level2">
<h2>11.5</h2>
<p>We first give the answer of 11.4.</p>
<ul>
<li>11.4</li>
</ul>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>) <span class="co">#values of ks</span></a>
<a class="sourceLine" id="cb91-2" title="2">s &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">25</span>) <span class="co"># to store the values of roots</span></a>
<a class="sourceLine" id="cb91-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">25</span>) {</a>
<a class="sourceLine" id="cb91-4" title="4">g &lt;-<span class="st"> </span><span class="cf">function</span>(a)</a>
<a class="sourceLine" id="cb91-5" title="5">{</a>
<a class="sourceLine" id="cb91-6" title="6">  q1 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k[i]<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(k[i]<span class="op">-</span>(a<span class="op">^</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb91-7" title="7">  p1 &lt;-<span class="st"> </span><span class="kw">pt</span>(q1, k[i]<span class="op">-</span><span class="dv">1</span>,<span class="dt">lower.tail =</span> F, <span class="dt">log.p =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb91-8" title="8">  q2 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k[i]<span class="op">/</span>(k[i]<span class="op">+</span><span class="dv">1</span><span class="op">-</span>(a<span class="op">^</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb91-9" title="9">  p2 &lt;-<span class="st"> </span><span class="kw">pt</span>(q2, k[i],<span class="dt">lower.tail =</span> F, <span class="dt">log.p =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb91-10" title="10">  <span class="kw">return</span>(p1<span class="op">-</span>p2)</a>
<a class="sourceLine" id="cb91-11" title="11">}</a>
<a class="sourceLine" id="cb91-12" title="12">s[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(g,<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="kw">sqrt</span>(k[i])<span class="op">-</span><span class="fl">0.01</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb91-13" title="13">}</a>
<a class="sourceLine" id="cb91-14" title="14">r &lt;-<span class="st"> </span><span class="kw">cbind</span>(k,s)</a>
<a class="sourceLine" id="cb91-15" title="15">r</a></code></pre></div>
<pre><code>##          k        s
##  [1,]    4 1.492103
##  [2,]    5 1.533559
##  [3,]    6 1.562745
##  [4,]    7 1.584429
##  [5,]    8 1.601158
##  [6,]    9 1.614525
##  [7,]   10 1.625413
##  [8,]   11 1.634378
##  [9,]   12 1.642026
## [10,]   13 1.648546
## [11,]   14 1.654196
## [12,]   15 1.659103
## [13,]   16 1.663449
## [14,]   17 1.667304
## [15,]   18 1.670700
## [16,]   19 1.673802
## [17,]   20 1.676614
## [18,]   21 1.679149
## [19,]   22 1.681471
## [20,]   23 1.683595
## [21,]   24 1.685546
## [22,]   25 1.687352
## [23,]  100 1.720608
## [24,]  500 1.729745
## [25,] 1000 1.730898</code></pre>
<ul>
<li>11.5</li>
</ul>
<p>For the computer can caculate the equation, we do some transformation of the equation, we change the integrating range to <span class="math inline">\((c_k,\infty)\)</span>, and take the logarithm of both sides.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb93-2" title="2">s &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">25</span>)</a>
<a class="sourceLine" id="cb93-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">25</span>) {</a>
<a class="sourceLine" id="cb93-4" title="4">  f &lt;-<span class="st"> </span><span class="cf">function</span>(u, k) (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb93-5" title="5">  ck &lt;-<span class="st"> </span><span class="cf">function</span>(a, k) <span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb93-6" title="6">  g &lt;-<span class="st"> </span><span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb93-7" title="7">    in1 &lt;-<span class="st"> </span><span class="kw">integrate</span>(f, <span class="dt">lower =</span> <span class="kw">ck</span>(a, k[i]), <span class="dt">upper =</span> <span class="ot">Inf</span>, <span class="dt">k =</span> k[i])<span class="op">$</span>value</a>
<a class="sourceLine" id="cb93-8" title="8">    in2 &lt;-<span class="st"> </span><span class="kw">integrate</span>(f, <span class="dt">lower =</span> <span class="kw">ck</span>(a, k[i]<span class="op">+</span><span class="dv">1</span>), <span class="dt">upper =</span> <span class="ot">Inf</span>, <span class="dt">k =</span> k[i]<span class="op">+</span><span class="dv">1</span>)<span class="op">$</span>value</a>
<a class="sourceLine" id="cb93-9" title="9">    p1 &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">lgamma</span>(k[i]<span class="op">/</span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span><span class="kw">log</span>(pi<span class="op">*</span>(k[i]<span class="op">-</span><span class="dv">1</span>)) <span class="op">-</span><span class="st"> </span><span class="kw">lgamma</span>((k[i]<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(in1)</a>
<a class="sourceLine" id="cb93-10" title="10">    p2 &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">lgamma</span>((k[i]<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span><span class="kw">log</span>(pi<span class="op">*</span>k[i]) <span class="op">-</span><span class="st"> </span><span class="kw">lgamma</span>(k[i]<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(in2)</a>
<a class="sourceLine" id="cb93-11" title="11">    <span class="kw">return</span>(p1<span class="op">-</span>p2)</a>
<a class="sourceLine" id="cb93-12" title="12">  }</a>
<a class="sourceLine" id="cb93-13" title="13">  s[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(g,<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="fl">1.9</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb93-14" title="14">}</a>
<a class="sourceLine" id="cb93-15" title="15">r &lt;-<span class="st"> </span><span class="kw">cbind</span>(k,s)</a>
<a class="sourceLine" id="cb93-16" title="16">r</a></code></pre></div>
<pre><code>##          k        s
##  [1,]    4 1.492132
##  [2,]    5 1.533558
##  [3,]    6 1.562760
##  [4,]    7 1.584433
##  [5,]    8 1.601207
##  [6,]    9 1.614526
##  [7,]   10 1.625386
##  [8,]   11 1.634410
##  [9,]   12 1.642026
## [10,]   13 1.648540
## [11,]   14 1.654174
## [12,]   15 1.659096
## [13,]   16 1.663433
## [14,]   17 1.667283
## [15,]   18 1.670724
## [16,]   19 1.673817
## [17,]   20 1.676614
## [18,]   21 1.679154
## [19,]   22 1.681472
## [20,]   23 1.683595
## [21,]   24 1.685546
## [22,]   25 1.687347
## [23,]  100 1.720582
## [24,]  500 1.729739
## [25,] 1000 1.730892</code></pre>
<p>As we show, the solutions and the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4 are almost the same.</p>
<p>A-B-O</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">library</span>(nloptr)</a>
<a class="sourceLine" id="cb95-2" title="2"><span class="co"># Mle </span></a>
<a class="sourceLine" id="cb95-3" title="3">eval_f0 =<span class="st"> </span><span class="cf">function</span>(x,x1,<span class="dt">n.A=</span><span class="dv">28</span>,<span class="dt">n.B=</span><span class="dv">24</span>,<span class="dt">nOO=</span><span class="dv">41</span>,<span class="dt">nAB=</span><span class="dv">70</span>) {</a>
<a class="sourceLine" id="cb95-4" title="4">  </a>
<a class="sourceLine" id="cb95-5" title="5">  r1 =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(x1)</a>
<a class="sourceLine" id="cb95-6" title="6">  nAA =<span class="st"> </span>n.A<span class="op">*</span>x1[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(x1[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>x1[<span class="dv">1</span>]<span class="op">*</span>r1)</a>
<a class="sourceLine" id="cb95-7" title="7">  nBB =<span class="st"> </span>n.B<span class="op">*</span>x1[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(x1[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>x1[<span class="dv">2</span>]<span class="op">*</span>r1)</a>
<a class="sourceLine" id="cb95-8" title="8">  r =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(x)</a>
<a class="sourceLine" id="cb95-9" title="9">  <span class="kw">return</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nAA<span class="op">*</span><span class="kw">log</span>(x[<span class="dv">1</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nBB<span class="op">*</span><span class="kw">log</span>(x[<span class="dv">2</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(r)<span class="op">-</span></a>
<a class="sourceLine" id="cb95-10" title="10"><span class="st">           </span>(n.A<span class="op">-</span>nAA)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>r)<span class="op">-</span>(n.B<span class="op">-</span>nBB)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">2</span>]<span class="op">*</span>r)<span class="op">-</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>x[<span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb95-11" title="11">}</a>
<a class="sourceLine" id="cb95-12" title="12"></a>
<a class="sourceLine" id="cb95-13" title="13"></a>
<a class="sourceLine" id="cb95-14" title="14"><span class="co"># constraint</span></a>
<a class="sourceLine" id="cb95-15" title="15">eval_g0 =<span class="st"> </span><span class="cf">function</span>(x,x1,<span class="dt">n.A=</span><span class="dv">28</span>,<span class="dt">n.B=</span><span class="dv">24</span>,<span class="dt">nOO=</span><span class="dv">41</span>,<span class="dt">nAB=</span><span class="dv">70</span>) {</a>
<a class="sourceLine" id="cb95-16" title="16">  <span class="kw">return</span>(<span class="kw">sum</span>(x)<span class="op">-</span><span class="fl">0.999999</span>)</a>
<a class="sourceLine" id="cb95-17" title="17">}</a>
<a class="sourceLine" id="cb95-18" title="18"></a>
<a class="sourceLine" id="cb95-19" title="19">opts =<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;algorithm&quot;</span>=<span class="st">&quot;NLOPT_LN_COBYLA&quot;</span>,</a>
<a class="sourceLine" id="cb95-20" title="20">             <span class="st">&quot;xtol_rel&quot;</span>=<span class="fl">1.0e-8</span>)</a>
<a class="sourceLine" id="cb95-21" title="21">mle =<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb95-22" title="22">r =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb95-23" title="23">r =<span class="st"> </span><span class="kw">rbind</span>(r,<span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.35</span>))<span class="co"># the beginning value of p0 and q0</span></a>
<a class="sourceLine" id="cb95-24" title="24">j =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb95-25" title="25"><span class="cf">while</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(r[j,]<span class="op">-</span>r[j<span class="dv">-1</span>,]))<span class="op">&gt;</span><span class="fl">1e-8</span>) {</a>
<a class="sourceLine" id="cb95-26" title="26">res =<span class="st"> </span><span class="kw">nloptr</span>( <span class="dt">x0=</span><span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.25</span>),</a>
<a class="sourceLine" id="cb95-27" title="27">               <span class="dt">eval_f=</span>eval_f0,</a>
<a class="sourceLine" id="cb95-28" title="28">               <span class="dt">lb =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">ub =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </a>
<a class="sourceLine" id="cb95-29" title="29">               <span class="dt">eval_g_ineq =</span> eval_g0, </a>
<a class="sourceLine" id="cb95-30" title="30">               <span class="dt">opts =</span> opts, <span class="dt">x1=</span>r[j,],<span class="dt">n.A=</span><span class="dv">28</span>,<span class="dt">n.B=</span><span class="dv">24</span>,<span class="dt">nOO=</span><span class="dv">41</span>,<span class="dt">nAB=</span><span class="dv">70</span> )</a>
<a class="sourceLine" id="cb95-31" title="31">j =<span class="st"> </span>j<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb95-32" title="32">r =<span class="st"> </span><span class="kw">rbind</span>(r,res<span class="op">$</span>solution)</a>
<a class="sourceLine" id="cb95-33" title="33">mle =<span class="st"> </span><span class="kw">c</span>(mle,<span class="kw">eval_f0</span>(<span class="dt">x=</span>r[j,],<span class="dt">x1=</span>r[j<span class="dv">-1</span>,]))</a>
<a class="sourceLine" id="cb95-34" title="34">}</a>
<a class="sourceLine" id="cb95-35" title="35"><span class="co">#the result of EM algorithm</span></a>
<a class="sourceLine" id="cb95-36" title="36">r </a></code></pre></div>
<pre><code>##            [,1]      [,2]
##  [1,] 0.0000000 0.0000000
##  [2,] 0.2000000 0.3500000
##  [3,] 0.3162298 0.3089571
##  [4,] 0.3260961 0.3098301
##  [5,] 0.3271807 0.3103186
##  [6,] 0.3273212 0.3104097
##  [7,] 0.3273409 0.3104241
##  [8,] 0.3273438 0.3104263
##  [9,] 0.3273442 0.3104266
## [10,] 0.3273442 0.3104267
## [11,] 0.3273442 0.3104267
## [12,] 0.3273442 0.3104267</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="co">#the max likelihood values</span></a>
<a class="sourceLine" id="cb97-2" title="2"><span class="kw">plot</span>(mle,<span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Homework 10</p>
<p>204.3</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb98-2" title="2">  mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb98-3" title="3">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb98-4" title="4">  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb98-5" title="5">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb98-6" title="6">)</a>
<a class="sourceLine" id="cb98-7" title="7"></a>
<a class="sourceLine" id="cb98-8" title="8">la1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas, lm, <span class="dt">data =</span> mtcars) <span class="co">#lapply</span></a>
<a class="sourceLine" id="cb98-9" title="9"></a>
<a class="sourceLine" id="cb98-10" title="10">lo1 &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(formulas)) <span class="co">#for loop</span></a>
<a class="sourceLine" id="cb98-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)) {</a>
<a class="sourceLine" id="cb98-12" title="12">  lo1[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(formulas[[i]], <span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb98-13" title="13">}</a></code></pre></div>
<p>204.4</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb99-2" title="2">  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb99-3" title="3">  mtcars[rows, ]</a>
<a class="sourceLine" id="cb99-4" title="4">})</a>
<a class="sourceLine" id="cb99-5" title="5"></a>
<a class="sourceLine" id="cb99-6" title="6">la2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(bootstraps, lm, <span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>disp) <span class="co">#apply</span></a>
<a class="sourceLine" id="cb99-7" title="7"></a>
<a class="sourceLine" id="cb99-8" title="8">lo2 &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(bootstraps)) <span class="co">#for loop</span></a>
<a class="sourceLine" id="cb99-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)){</a>
<a class="sourceLine" id="cb99-10" title="10">  lo2[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp, <span class="dt">data =</span> bootstraps[[i]])</a>
<a class="sourceLine" id="cb99-11" title="11">}</a></code></pre></div>
<p>204.5</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb100-2" title="2"></a>
<a class="sourceLine" id="cb100-3" title="3"><span class="kw">sapply</span>(la1, rsq) <span class="co">#3 la1</span></a></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"><span class="kw">sapply</span>(lo1, rsq) <span class="co">#3 lo1</span></a></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">sapply</span>(la2, rsq) <span class="co">#4 la2</span></a></code></pre></div>
<pre><code>##  [1] 0.7461294 0.6176659 0.6965401 0.7148349 0.5698312 0.6897326 0.6396849
##  [8] 0.7526921 0.7331388 0.6820759</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1"><span class="kw">sapply</span>(lo2, rsq) <span class="co">#4 lo2</span></a></code></pre></div>
<pre><code>##  [1] 0.7461294 0.6176659 0.6965401 0.7148349 0.5698312 0.6897326 0.6396849
##  [8] 0.7526921 0.7331388 0.6820759</code></pre>
<p>214.3</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</a>
<a class="sourceLine" id="cb108-2" title="2">  <span class="dv">100</span>, </a>
<a class="sourceLine" id="cb108-3" title="3">  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb108-4" title="4">  <span class="dt">simplify =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb108-5" title="5">)</a>
<a class="sourceLine" id="cb108-6" title="6"></a>
<a class="sourceLine" id="cb108-7" title="7"><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x[[<span class="st">&quot;p.value&quot;</span>]])</a></code></pre></div>
<pre><code>##   [1] 0.682579390 0.228980839 0.767268870 0.629387757 0.117155516
##   [6] 0.002564554 0.377136009 0.889373684 0.834126503 0.870489919
##  [11] 0.456360501 0.754202818 0.271690092 0.815227288 0.963175743
##  [16] 0.540776729 0.017513718 0.245531416 0.140489687 0.280932793
##  [21] 0.418246558 0.355934209 0.218203236 0.236775900 0.874652585
##  [26] 0.558729333 0.659629273 0.525949870 0.844532058 0.646857726
##  [31] 0.301147687 0.991447574 0.842916401 0.843826799 0.363111207
##  [36] 0.457019996 0.162333634 0.546993069 0.113233336 0.754563386
##  [41] 0.608378953 0.205713997 0.403690430 0.640279707 0.421892741
##  [46] 0.209798529 0.094661314 0.154355121 0.352989593 0.318575214
##  [51] 0.958980488 0.545296891 0.793467694 0.834694172 0.933308351
##  [56] 0.577009501 0.453491454 0.969183171 0.506965116 0.334184177
##  [61] 0.979575781 0.978423090 0.685258697 0.791791809 0.636789078
##  [66] 0.589813315 0.073560051 0.416538920 0.652633742 0.609248580
##  [71] 0.117167552 0.622489301 0.483962467 0.992224529 0.977448449
##  [76] 0.814495518 0.872945123 0.687161654 0.048600631 0.930235146
##  [81] 0.226889294 0.973018881 0.591935495 0.316897765 0.309409794
##  [86] 0.325553850 0.631042384 0.824413623 0.489240924 0.685758937
##  [91] 0.460572769 0.526574999 0.283109634 0.586845468 0.808670717
##  [96] 0.851338787 0.684540913 0.061068167 0.566197559 0.070183184</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a></code></pre></div>
<p>214.7</p>
<p>Because I use windows so I write function parsapply(), a multicore version of sapply using parLapply() instead of using mclapply(). And I don’t think we can implement a mcvapply(), because we cannot pre-spacify the return value type in parallel.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb111-2" title="2">parsapply &lt;-<span class="st"> </span><span class="cf">function</span> (<span class="dt">cl =</span> <span class="ot">NULL</span>, X, FUN, ..., <span class="dt">simplify =</span> <span class="ot">TRUE</span>, <span class="dt">USE.NAMES =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb111-3" title="3">  <span class="dt">chunk.size =</span> <span class="ot">NULL</span>) </a>
<a class="sourceLine" id="cb111-4" title="4">{</a>
<a class="sourceLine" id="cb111-5" title="5">  FUN &lt;-<span class="st"> </span><span class="kw">match.fun</span>(FUN)</a>
<a class="sourceLine" id="cb111-6" title="6">  answer &lt;-<span class="st"> </span><span class="kw">parLapply</span>(<span class="dt">cl =</span> cl, <span class="dt">X =</span> <span class="kw">as.list</span>(X), <span class="dt">fun =</span> FUN, </a>
<a class="sourceLine" id="cb111-7" title="7">    ..., <span class="dt">chunk.size =</span> chunk.size)</a>
<a class="sourceLine" id="cb111-8" title="8">  <span class="cf">if</span> (USE.NAMES <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.character</span>(X) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.null</span>(<span class="kw">names</span>(answer))) </a>
<a class="sourceLine" id="cb111-9" title="9">    <span class="kw">names</span>(answer) &lt;-<span class="st"> </span>X</a>
<a class="sourceLine" id="cb111-10" title="10">  <span class="cf">if</span> (<span class="op">!</span><span class="kw">isFALSE</span>(simplify) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(answer)) </a>
<a class="sourceLine" id="cb111-11" title="11">    <span class="kw">simplify2array</span>(answer, <span class="dt">higher =</span> (simplify <span class="op">==</span><span class="st"> &quot;array&quot;</span>))</a>
<a class="sourceLine" id="cb111-12" title="12">  <span class="cf">else</span> answer</a>
<a class="sourceLine" id="cb111-13" title="13">}</a>
<a class="sourceLine" id="cb111-14" title="14"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a></code></pre></div>
<p>Homework 11</p>
<p>exercise</p>
<p>You have already written an R function for Exercise 9.4 (page 277, Statistical Computing with R). Rewrite an Rcpp function for the same task. Compare the generated random numbers by the two functions using qqplot. Campare the computation time of the two functions with microbenchmark. Comments your results.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb112-2" title="2"><span class="kw">library</span>(microbenchmark)</a></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本3.6.2 来建造的</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1">rwM&lt;-<span class="cf">function</span>(x0,sigma,N){ <span class="co"># R function</span></a>
<a class="sourceLine" id="cb114-2" title="2">  x&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb114-3" title="3">  x[<span class="dv">1</span>]&lt;-x0</a>
<a class="sourceLine" id="cb114-4" title="4">  u&lt;-<span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb114-5" title="5">  k&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb114-6" title="6">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb114-7" title="7">    y&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dt">mean=</span>x[i<span class="dv">-1</span>],<span class="dt">sd=</span>sigma)</a>
<a class="sourceLine" id="cb114-8" title="8">    <span class="cf">if</span>(u[i]<span class="op">&lt;=</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y))<span class="op">/</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x[i<span class="dv">-1</span>]))) {</a>
<a class="sourceLine" id="cb114-9" title="9">      x[i]&lt;-y</a>
<a class="sourceLine" id="cb114-10" title="10">      k&lt;-k<span class="op">+</span><span class="dv">1</span>}</a>
<a class="sourceLine" id="cb114-11" title="11">    <span class="cf">else</span> x[i]&lt;-x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb114-12" title="12">  }</a>
<a class="sourceLine" id="cb114-13" title="13">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x,<span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb114-14" title="14">}</a>
<a class="sourceLine" id="cb114-15" title="15"></a>
<a class="sourceLine" id="cb114-16" title="16"><span class="co">#Rcpp function</span></a>
<a class="sourceLine" id="cb114-17" title="17"><span class="kw">cppFunction</span>(<span class="st">&#39;List rwMc(double x0, double sigma, int N){</span></a>
<a class="sourceLine" id="cb114-18" title="18"><span class="st">NumericVector x(N);</span></a>
<a class="sourceLine" id="cb114-19" title="19"><span class="st">x[0]=x0;</span></a>
<a class="sourceLine" id="cb114-20" title="20"><span class="st">int k=0;</span></a>
<a class="sourceLine" id="cb114-21" title="21"><span class="st">for(int i=1;i&lt;N;i++){</span></a>
<a class="sourceLine" id="cb114-22" title="22"></a>
<a class="sourceLine" id="cb114-23" title="23"><span class="st">double y=as&lt;double&gt;(rnorm(1,x[i-1], sigma));</span></a>
<a class="sourceLine" id="cb114-24" title="24"><span class="st">double u=as&lt;double&gt;(runif(1));</span></a>
<a class="sourceLine" id="cb114-25" title="25"></a>
<a class="sourceLine" id="cb114-26" title="26"><span class="st">if (u&lt;=exp(-abs(y))/exp(-abs(x[i-1]))) {</span></a>
<a class="sourceLine" id="cb114-27" title="27"><span class="st">x[i]=y;</span></a>
<a class="sourceLine" id="cb114-28" title="28"><span class="st">k=k+1;  </span></a>
<a class="sourceLine" id="cb114-29" title="29"><span class="st">}</span></a>
<a class="sourceLine" id="cb114-30" title="30"><span class="st">else x[i]=x[i-1];</span></a>
<a class="sourceLine" id="cb114-31" title="31"><span class="st">}</span></a>
<a class="sourceLine" id="cb114-32" title="32"></a>
<a class="sourceLine" id="cb114-33" title="33"><span class="st">return(List::create(Named(&quot;x&quot;)=x,Named(&quot;k&quot;)=k));</span></a>
<a class="sourceLine" id="cb114-34" title="34"><span class="st">}&#39;</span>)</a>
<a class="sourceLine" id="cb114-35" title="35"></a>
<a class="sourceLine" id="cb114-36" title="36">sigma&lt;-<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="dv">2</span>,<span class="dv">16</span>)</a>
<a class="sourceLine" id="cb114-37" title="37">x0&lt;-<span class="dv">25</span></a>
<a class="sourceLine" id="cb114-38" title="38">N&lt;-<span class="dv">2000</span></a>
<a class="sourceLine" id="cb114-39" title="39"><span class="kw">set.seed</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb114-40" title="40"></a>
<a class="sourceLine" id="cb114-41" title="41">rw1&lt;-<span class="kw">rwM</span>(x0,sigma[<span class="dv">1</span>],N) <span class="co">#R samples</span></a>
<a class="sourceLine" id="cb114-42" title="42">rw2&lt;-<span class="kw">rwM</span>(x0,sigma[<span class="dv">2</span>],N)</a>
<a class="sourceLine" id="cb114-43" title="43">rw3&lt;-<span class="kw">rwM</span>(x0,sigma[<span class="dv">3</span>],N)</a>
<a class="sourceLine" id="cb114-44" title="44">rw4&lt;-<span class="kw">rwM</span>(x0,sigma[<span class="dv">4</span>],N)</a>
<a class="sourceLine" id="cb114-45" title="45"></a>
<a class="sourceLine" id="cb114-46" title="46">rwc1&lt;-<span class="kw">rwMc</span>(x0,sigma[<span class="dv">1</span>],N) <span class="co">#Rcpp samples</span></a>
<a class="sourceLine" id="cb114-47" title="47">rwc2&lt;-<span class="kw">rwMc</span>(x0,sigma[<span class="dv">2</span>],N)</a>
<a class="sourceLine" id="cb114-48" title="48">rwc3&lt;-<span class="kw">rwMc</span>(x0,sigma[<span class="dv">3</span>],N)</a>
<a class="sourceLine" id="cb114-49" title="49">rwc4&lt;-<span class="kw">rwMc</span>(x0,sigma[<span class="dv">4</span>],N)</a>
<a class="sourceLine" id="cb114-50" title="50"><span class="co">#par(mfrow=c(2,2))</span></a>
<a class="sourceLine" id="cb114-51" title="51"></a>
<a class="sourceLine" id="cb114-52" title="52"><span class="kw">qqplot</span>(rw1<span class="op">$</span>x,rwc1<span class="op">$</span>x) <span class="co">#compare qqplot</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="kw">qqplot</span>(rw2<span class="op">$</span>x,rwc2<span class="op">$</span>x)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1"><span class="kw">qqplot</span>(rw3<span class="op">$</span>x,rwc4<span class="op">$</span>x)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">qqplot</span>(rw4<span class="op">$</span>x,rwc4<span class="op">$</span>x)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"><span class="co">#compare computing time</span></a>
<a class="sourceLine" id="cb118-2" title="2">ts1&lt;-<span class="kw">microbenchmark</span>(<span class="kw">rwM</span>(x0,sigma[<span class="dv">1</span>],N),<span class="kw">rwMc</span>(x0,sigma[<span class="dv">1</span>],N)) </a>
<a class="sourceLine" id="cb118-3" title="3">ts2&lt;-<span class="kw">microbenchmark</span>(<span class="kw">rwM</span>(x0,sigma[<span class="dv">2</span>],N),<span class="kw">rwMc</span>(x0,sigma[<span class="dv">2</span>],N))</a>
<a class="sourceLine" id="cb118-4" title="4">ts3&lt;-<span class="kw">microbenchmark</span>(<span class="kw">rwM</span>(x0,sigma[<span class="dv">3</span>],N),<span class="kw">rwMc</span>(x0,sigma[<span class="dv">3</span>],N))</a>
<a class="sourceLine" id="cb118-5" title="5">ts4&lt;-<span class="kw">microbenchmark</span>(<span class="kw">rwM</span>(x0,sigma[<span class="dv">4</span>],N),<span class="kw">rwMc</span>(x0,sigma[<span class="dv">4</span>],N))</a>
<a class="sourceLine" id="cb118-6" title="6"><span class="kw">summary</span>(ts1)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##                    expr     lq  median     uq
## 1  rwM(x0, sigma[1], N) 3035.4 3117.70 3238.0
## 2 rwMc(x0, sigma[1], N)  310.5  314.55  318.8</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="kw">summary</span>(ts2)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##                    expr      lq  median     uq
## 1  rwM(x0, sigma[2], N) 3079.30 3153.15 3267.2
## 2 rwMc(x0, sigma[2], N)  268.35  272.30  278.3</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1"><span class="kw">summary</span>(ts3)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##                    expr      lq  median      uq
## 1  rwM(x0, sigma[3], N) 3095.15 3178.70 3363.90
## 2 rwMc(x0, sigma[3], N)  285.00  287.35  290.85</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1"><span class="kw">summary</span>(ts4)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##                    expr      lq  median      uq
## 1  rwM(x0, sigma[4], N) 3069.90 3123.55 3202.25
## 2 rwMc(x0, sigma[4], N)  284.45  286.95  290.10</code></pre>
<p>As we show, we found that rcpp can save a lot of time.However the qqplot told us that the random numbers are not much the same for r and rcpp function.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
